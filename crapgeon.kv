#: import DungeonStats game_stats.DungeonStats
#: import JerkyStats game_stats.JerkyStats
#: import CoffeeStats game_stats.CoffeeStats
#: import TobaccoStats game_stats.TobaccoStats
#: import WhiskyStats game_stats.WhiskyStats
#: import DungeonLayout dungeon_classes.DungeonLayout


<Label>:
    text_size: self.size    # needed to make halign work  
    halign: 'left'
    valign: 'center'
    font_size: '20sp'
    #padding: '20dp', '10dp', '20dp', '10dp'

<Button>:
    halign: 'center'
    disabled: True


<Tile>:
    background_normal: ''   # sets the background default to white instead of predefined grey
    background_color: 0.4, 0.8, 1, 1
    size_hint: None,None
    width: '60dp'
    height: self.width
    kind: None

    canvas:
        Color:
            rgba: (1,1,1,0.8) if not self.disabled else (1,1,1,1)

        Rectangle:  # draws the floor      
            pos: self.pos
            size: self.size
            source: "./backgrounds/" + self.kind + 'background.png' if self.kind else None


<ScrollView>:
    effect_cls: 'ScrollEffect'  # avoids bouncing when reaching end of scroll


<CrapgeonGame>:
    orientation: 'vertical'
    padding: '5dp'

    level: app.level
    active_character: None

    on_active_character_id: 
        name_label.text = str(root.active_character.name)
        ability_button.text = ability_button.display_text()
    on_shovels: shovels_label.text = 'Shovels: ' + str(root.active_character.stats.shovels)
    on_weapons: weapons_label.text = 'Weapons: ' + str(root.active_character.stats.weapons)
    on_gems: gems_label.text = 'Gems: ' + str(root.active_character.gems) + '/' + str(root.total_gems)
    
    # HEADER LABELS: CHARACTER NAME AND FLOOR NUMBER
    BoxLayout:
        padding: '5dp'
        orientation: 'horizontal'
        size_hint: 1, 0.1
        
        Label:
            id: name_label
            size_hint: 0.6, 1
            font_size: '23sp'

        AbilityButton:
            size_hint: 0.4, 1
            id: ability_button
            game: root
            
    # GUI: CHARACTER STATS AND INVENTORY
    BoxLayout:
        orientation: 'horizontal'
        size_hint: 1, 0.3
        padding: '5dp'

        #CHARACTER STATS
        BoxLayout:
            orientation: 'vertical'
            size_hint: 0.5,1
            spacing: '5dp'

            Label:
                id: level_label
                text: 'FLOOR 1'
            Label:
                id: weapons_label
            Label:  
                id: shovels_label
            Label:
                id: gems_label

        #INVENTORY
        BoxLayout:
            orientation: 'vertical'
            size_hint: 0.5,1
            spacing: '5dp'

            JerkyButton:
                text: "Jerky"
                id: jerky_button
                stats: JerkyStats()
                game: root
            CoffeeButton:
                text: "Coffee"
                id: coffee_button
                stats: CoffeeStats()
                game: root
            TobaccoButton:
                text: "Tobacco"
                id: tobacco_button
                stats: TobaccoStats()
                game: root
            WhiskyButton:
                text: "Whisky"
                id: whisky_button
                stats: WhiskyStats()
                game: root
            TalismanButton:
                text: "Talisman"
                id: talisman_button
                game: root

    ScrollView:
        size_hint: 1, 0.6
    
        DungeonLayout:
            tiles_dict: None
            stats: DungeonStats()
            level: self.stats.level
            size_hint: None, None
            height: self.minimum_height
            width: self.minimum_width
            rows: self.stats.size()
            cols: self.stats.size()